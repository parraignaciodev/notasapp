{
  "version": 3,
  "sources": ["angular:jit:template:src\\app\\home\\home.page.html", "angular:jit:style:src\\app\\home\\home.page.scss", "src/app/home/home.page.ts", "src/app/home/home.page.spec.ts"],
  "sourcesContent": ["<ion-header class=\"ion-no-border\">\n  <ion-toolbar class=\"glass-header\">\n    <ion-title size=\"large\" class=\"main-title\">Mis Notas</ion-title>\n    <ion-buttons slot=\"end\">\n      <ion-button fill=\"clear\" (click)=\"irApiTareas()\">API</ion-button>\n      <ion-button (click)=\"cerrarSesion()\" color=\"primary\" style=\"font-weight: 600;\">\n        Salir\n      </ion-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content fullscreen class=\"ion-padding home-content\">\n\n  <div class=\"welcome-section animate-entry\">\n    <h1 class=\"greeting\">Hola, <span class=\"username\">{{ nombreUsuario }}</span> \uD83D\uDC4B</h1>\n    <p class=\"subtitle\">\u00BFQu\u00E9 tienes en mente hoy?</p>\n  </div>\n\n  <!-- Buscador -->\n  <div class=\"search-container animate-entry\" style=\"animation-delay: 0.1s;\">\n    <ion-searchbar placeholder=\"Buscar en tus notas...\" [(ngModel)]=\"query\" class=\"custom-search\" debounce=\"150\"\n      showCancelButton=\"focus\">\n    </ion-searchbar>\n  </div>\n\n  <!-- Lista de notas -->\n  <div *ngIf=\"tareasFiltradas.length > 0; else sinTareas\" class=\"notes-grid animate-entry\"\n    style=\"animation-delay: 0.2s;\">\n    <div *ngFor=\"let tarea of tareasFiltradas\" class=\"note-card custom-card\"\n      [style.--note-color]=\"getNoteBg(tarea.color)\" (click)=\"verDetalle(tarea)\">\n    \n          <!-- mini preview de la foto -->\n      <div class=\"note-photo\" *ngIf=\"tarea.fotoData\">\n        <img [src]=\"tarea.fotoData\" alt=\"Foto tarea\" />\n      </div>\n\n      <div class=\"note-content\">\n        <div class=\"note-header\">\n          <h2 class=\"note-title\">{{ tarea.titulo }}</h2>\n          <ion-icon *ngIf=\"tarea.completada\" name=\"checkmark-circle\" color=\"success\"></ion-icon>\n        </div>\n\n        <p class=\"note-desc\">{{ tarea.descripcion }}</p>\n\n        <div class=\"note-footer\">\n          <span class=\"note-date\">{{ formatFechaHora(tarea.updatedAt || tarea.createdAt) }}</span>\n          <span class=\"status-badge\" [class.done]=\"tarea.completada\">\n            {{ tarea.completada ? 'Listo' : 'Pendiente' }}\n          </span>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <ng-template #sinTareas>\n    <div class=\"empty-state animate-entry\" style=\"animation-delay: 0.2s;\">\n      <img src=\"assets/icon/favicon.png\" alt=\"No notes\" class=\"empty-img\"\n        style=\"opacity: 0.5; width: 80px; filter: grayscale(1);\">\n      <h3>No hay nada por aqu\u00ED</h3>\n      <p>Toca el bot\u00F3n + para crear una nota</p>\n    </div>\n  </ng-template>\n\n  <!-- FAB -->\n  <ion-fab vertical=\"bottom\" horizontal=\"end\" slot=\"fixed\" class=\"custom-fab\">\n    <ion-fab-button (click)=\"irAgregar()\" color=\"primary\">\n      <ion-icon name=\"add\"></ion-icon>\n    </ion-fab-button>\n  </ion-fab>\n</ion-content>", "/* src/app/home/home.page.scss */\n.home-content {\n  --background: var(--ion-background-color);\n}\n.main-title {\n  font-weight: 700;\n  color: var(--ion-text-color);\n  letter-spacing: -0.5px;\n}\n.welcome-section {\n  margin-bottom: 24px;\n  padding: 0 8px;\n}\n.greeting {\n  font-size: 28px;\n  font-weight: 700;\n  margin: 0;\n  color: var(--ion-text-color);\n}\n.greeting .username {\n  color: var(--ion-color-primary);\n}\n.subtitle {\n  font-size: 16px;\n  color: var(--ion-color-medium);\n  margin-top: 4px;\n}\n.search-container {\n  margin-bottom: 24px;\n}\n.custom-search {\n  --background: #fff;\n  --placeholder-color: var(--ion-color-medium);\n  --icon-color: var(--ion-color-primary);\n  padding-inline-start: 0;\n  padding-inline-end: 0;\n}\nbody.dark .custom-search {\n  --background: #2a2a2a;\n}\n.notes-grid {\n  column-count: 2;\n  column-gap: 16px;\n  padding-bottom: 80px;\n}\n.note-card {\n  break-inside: avoid;\n  margin-bottom: 16px;\n  background-color: var(--note-color, #fff);\n  border: 1px solid rgba(0, 0, 0, 0.03);\n  position: relative;\n}\n.note-card:not([style*=--note-color]) {\n  background-color: var(--ion-card-background);\n}\n.note-photo {\n  width: 100%;\n  max-height: 140px;\n  overflow: hidden;\n  border-radius: 12px;\n  margin-bottom: 8px;\n}\n.note-photo img {\n  width: 100%;\n  height: 140px;\n  object-fit: cover;\n  display: block;\n}\n.note-content {\n  padding: 16px;\n}\n.note-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 8px;\n}\n.note-title {\n  font-size: 16px;\n  font-weight: 600;\n  margin: 0;\n  color: #333;\n  line-height: 1.3;\n}\nbody.dark .note-card:not([style*=--note-color]) .note-title {\n  color: var(--ion-text-color);\n}\n.note-desc {\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.7);\n  margin: 0 0 12px 0;\n  line-height: 1.5;\n  display: -webkit-box;\n  -webkit-line-clamp: 4;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  line-clamp: 4;\n}\nbody.dark .note-card:not([style*=--note-color]) .note-desc {\n  color: var(--ion-color-medium);\n}\n.note-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 12px;\n}\n.note-date {\n  color: rgba(0, 0, 0, 0.5);\n}\nbody.dark .note-card:not([style*=--note-color]) .note-date {\n  color: var(--ion-color-medium);\n}\n.status-badge {\n  padding: 4px 8px;\n  border-radius: 12px;\n  background: rgba(0, 0, 0, 0.05);\n  color: rgba(0, 0, 0, 0.6);\n  font-weight: 500;\n}\n.status-badge.done {\n  background: var(--ion-color-success);\n  color: #fff;\n}\n.empty-state {\n  text-align: center;\n  margin-top: 60px;\n  color: var(--ion-color-medium);\n}\n.empty-state h3 {\n  font-size: 20px;\n  font-weight: 600;\n  margin-bottom: 8px;\n}\n.empty-state p {\n  font-size: 16px;\n}\n@media (min-width: 768px) {\n  .notes-grid {\n    column-count: 3;\n  }\n}\n@media (min-width: 1024px) {\n  .notes-grid {\n    column-count: 4;\n  }\n}\n/*# sourceMappingURL=home.page.css.map */\n", "import { Component, OnInit } from '@angular/core';\nimport { CommonModule, DatePipe } from '@angular/common';\nimport { Router } from '@angular/router';\nimport { IonicModule } from '@ionic/angular';\nimport { FormsModule } from '@angular/forms';\nimport { AuthService } from '../services/auth.service';\nimport { SqliteService } from '../services/sqlite.service';  // ðŸ‘ˆ NUEVO\n\ninterface Tarea {\n  id: number;\n  titulo: string;\n  descripcion: string;\n  completada?: boolean;\n  createdAt?: string;   // ISO\n  updatedAt?: string;   // ISO\n  color?: NoteColorKey; // nombre de color\n\n  fotoData?: string;    // data URL (base64) de la foto\n  lat?: number;\n  lng?: number;\n}\n\ntype NoteColorKey = 'sun' | 'sky' | 'mint' | 'lavender' | 'peach' | 'gray';\n\nconst NOTE_BG: Record<NoteColorKey, string> = {\n  sun: 'var(--note-sun)',\n  sky: 'var(--note-sky)',\n  mint: 'var(--note-mint)',\n  lavender: 'var(--note-lavender)',\n  peach: 'var(--note-peach)',\n  gray: 'var(--note-gray)',\n};\n\n@Component({\n  selector: 'app-home',\n  templateUrl: './home.page.html',\n  styleUrls: ['./home.page.scss'],\n  standalone: true,\n  imports: [CommonModule, IonicModule, FormsModule],\n  providers: [DatePipe]\n})\nexport class HomePage implements OnInit {\n  tareas: Tarea[] = [];\n  nombreUsuario = '';\n  query = '';\n\n  // paleta por si luego quieres asignar aleatoria u ofrecer selector\n  private palette: NoteColorKey[] = ['sun', 'sky', 'mint', 'lavender', 'peach', 'gray'];\n\n  constructor(\n    private router: Router,\n    private authService: AuthService,\n    private datePipe: DatePipe,\n    private sqlite: SqliteService         // ðŸ‘ˆ NUEVO\n  ) {}\n\n  ngOnInit() {\n    this.cargarTareas();  // localStorage\n    this.authService.usuario$.subscribe(usuario => {\n      this.nombreUsuario = usuario ?? '';\n    });\n  }\n\n  async ionViewWillEnter() {\n    // Seguir cargando desde localStorage como siempre\n    this.cargarTareas();\n\n    // ðŸ” Smoke test de SQLite SOLO en nativo (Android / iOS)\n    if (this.sqlite.isNative) {\n      try {\n        const notes = await this.sqlite.list();\n        console.log('[SQLite] Notas en tabla notes:', notes);\n      } catch (err) {\n        console.error('[SQLite] Error al listar notas', err);\n      }\n    } else {\n      // En web no hay SQLite nativo, asÃ­ que no llamamos list()\n      console.log('[SQLite] Ejecutando en web, usando solo localStorage por ahora');\n    }\n  }\n\n  getNoteBg(color?: NoteColorKey) {\n    return NOTE_BG[(color as NoteColorKey) || 'gray'];\n  }\n\n  cargarTareas() {\n    const stored = localStorage.getItem('tareas');\n    const raw: Tarea[] = stored ? JSON.parse(stored) : [];\n\n    // MigraciÃ³n suave: completar createdAt / updatedAt / color si faltan\n    const migrated = raw.map(t => {\n      const created = t.createdAt ?? new Date().toISOString();\n      const updated = t.updatedAt ?? created;\n      const color   = (t.color as NoteColorKey) ?? 'gray';\n      return { ...t, createdAt: created, updatedAt: updated, color };\n    });\n\n    if (JSON.stringify(raw) !== JSON.stringify(migrated)) {\n      localStorage.setItem('tareas', JSON.stringify(migrated));\n    }\n\n    this.tareas = migrated;\n  }\n\n  get tareasFiltradas(): Tarea[] {\n    const q = this.query.trim().toLowerCase();\n    if (!q) return this.tareas;\n    return this.tareas.filter(t =>\n      (t.titulo || '').toLowerCase().includes(q) ||\n      (t.descripcion || '').toLowerCase().includes(q)\n    );\n  }\n\n  formatFechaHora(iso?: string): string {\n    const d = iso ? new Date(iso) : new Date();\n    return this.datePipe.transform(d, 'MMM d, HH:mm', 'es-CL') ?? '';\n  }\n\n  verDetalle(tarea: Tarea) {\n    this.router.navigate(['/detalle-tarea', tarea.id]);\n  }\n\n  irAgregar() {\n    this.router.navigate(['/agregar-tarea']);\n  }\n\n  cerrarSesion() {\n    this.authService.logout();\n    this.router.navigate(['/login']);\n  }\n\n  // (opcional) si en algÃºn momento quieres usar clases ademÃ¡s del inline style\n  colorClass(t: Tarea) {\n    const c = (t.color as NoteColorKey) ?? 'gray';\n    return `note--${c}`;\n  }\n\n  irApiTareas() {\n    this.router.navigate(['/api-tareas']);\n  }\n}\n\n\n\n\n", "import { ComponentFixture, TestBed } from '@angular/core/testing';\nimport { HomePage } from './home.page';\nimport { Router } from '@angular/router';\nimport { AuthService } from '../services/auth.service';\nimport { DatePipe } from '@angular/common';\nimport { SqliteService } from '../services/sqlite.service';\nimport { of } from 'rxjs';\n\ndescribe('HomePage', () => {\n  let component: HomePage;\n  let fixture: ComponentFixture<HomePage>;\n\n  beforeEach(async () => {\n    const authSpy = jasmine.createSpyObj('AuthService', [], {\n      usuario$: of('testuser')\n    });\n    const routerSpy = jasmine.createSpyObj('Router', ['navigate']);\n    const sqliteSpy = jasmine.createSpyObj('SqliteService', [], {\n      isNative: false\n    });\n\n    await TestBed.configureTestingModule({\n      imports: [HomePage],\n      providers: [\n        { provide: Router, useValue: routerSpy },\n        { provide: AuthService, useValue: authSpy },\n        DatePipe,\n        { provide: SqliteService, useValue: sqliteSpy }\n      ]\n    }).compileComponents();\n\n    fixture = TestBed.createComponent(HomePage);\n    component = fixture.componentInstance;\n    fixture.detectChanges();\n  });\n\n  it('should create', () => {\n    expect(component).toBeTruthy();\n  });\n});\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAA,IAAAA;AAAA,IAAAC,kBAAA;AAAA;AAAA,IAAAD,qBAAA;AAAA;AAAA;;;ICwBM,SAiBO;;;;;;;AAzCb;AACA;AACA;AACA;AACA;AACA;AACA;AAkBA,IAAM,UAAwC;MAC5C,KAAK;MACL,KAAK;MACL,MAAM;MACN,UAAU;MACV,OAAO;MACP,MAAM;;AAWD,IAAM,WAAN,MAAME,UAAQ;MAQnB,YACU,QACA,aACA,UACA;AAHA,aAAA,SAAA;AACA,aAAA,cAAA;AACA,aAAA,WAAA;AACA,aAAA,SAAA;AAXV,aAAA,SAAkB,CAAA;AAClB,aAAA,gBAAgB;AAChB,aAAA,QAAQ;AAGA,aAAA,UAA0B,CAAC,OAAO,OAAO,QAAQ,YAAY,SAAS,MAAM;MAOjF;MAEH,WAAQ;AACN,aAAK,aAAY;AACjB,aAAK,YAAY,SAAS,UAAU,aAAU;AAC5C,eAAK,gBAAgB,WAAW;QAClC,CAAC;MACH;MAEM,mBAAgB;;AAEpB,eAAK,aAAY;AAGjB,cAAI,KAAK,OAAO,UAAU;AACxB,gBAAI;AACF,oBAAM,QAAQ,MAAM,KAAK,OAAO,KAAI;AACpC,sBAAQ,IAAI,kCAAkC,KAAK;YACrD,SAAS,KAAK;AACZ,sBAAQ,MAAM,kCAAkC,GAAG;YACrD;UACF,OAAO;AAEL,oBAAQ,IAAI,gEAAgE;UAC9E;QACF;;MAEA,UAAU,OAAoB;AAC5B,eAAO,QAAS,SAA0B,MAAM;MAClD;MAEA,eAAY;AACV,cAAM,SAAS,aAAa,QAAQ,QAAQ;AAC5C,cAAM,MAAe,SAAS,KAAK,MAAM,MAAM,IAAI,CAAA;AAGnD,cAAM,WAAW,IAAI,IAAI,OAAI;AAC3B,gBAAM,UAAU,EAAE,cAAa,oBAAI,KAAI,GAAG,YAAW;AACrD,gBAAM,UAAU,EAAE,aAAa;AAC/B,gBAAM,QAAW,EAAE,SAA0B;AAC7C,iBAAO,iCAAK,IAAL,EAAQ,WAAW,SAAS,WAAW,SAAS,MAAK;QAC9D,CAAC;AAED,YAAI,KAAK,UAAU,GAAG,MAAM,KAAK,UAAU,QAAQ,GAAG;AACpD,uBAAa,QAAQ,UAAU,KAAK,UAAU,QAAQ,CAAC;QACzD;AAEA,aAAK,SAAS;MAChB;MAEA,IAAI,kBAAe;AACjB,cAAM,IAAI,KAAK,MAAM,KAAI,EAAG,YAAW;AACvC,YAAI,CAAC;AAAG,iBAAO,KAAK;AACpB,eAAO,KAAK,OAAO,OAAO,QACvB,EAAE,UAAU,IAAI,YAAW,EAAG,SAAS,CAAC,MACxC,EAAE,eAAe,IAAI,YAAW,EAAG,SAAS,CAAC,CAAC;MAEnD;MAEA,gBAAgB,KAAY;AAC1B,cAAM,IAAI,MAAM,IAAI,KAAK,GAAG,IAAI,oBAAI,KAAI;AACxC,eAAO,KAAK,SAAS,UAAU,GAAG,gBAAgB,OAAO,KAAK;MAChE;MAEA,WAAW,OAAY;AACrB,aAAK,OAAO,SAAS,CAAC,kBAAkB,MAAM,EAAE,CAAC;MACnD;MAEA,YAAS;AACP,aAAK,OAAO,SAAS,CAAC,gBAAgB,CAAC;MACzC;MAEA,eAAY;AACV,aAAK,YAAY,OAAM;AACvB,aAAK,OAAO,SAAS,CAAC,QAAQ,CAAC;MACjC;;MAGA,WAAW,GAAQ;AACjB,cAAM,IAAK,EAAE,SAA0B;AACvC,eAAO,SAAS,CAAC;MACnB;MAEA,cAAW;AACT,aAAK,OAAO,SAAS,CAAC,aAAa,CAAC;MACtC;;;;;;;;;;AAlGW,eAAQ,WAAA;MARpB,UAAU;QACT,UAAU;QACV,UAAA;QAEA,YAAY;QACZ,SAAS,CAAC,cAAc,aAAa,WAAW;QAChD,WAAW,CAAC,QAAQ;;OACrB;OACY,QAAQ;;;;;ACzCrB;;;AACA,IAAAC;AACA;AACA;AACA;AACA;AACA;AAEA,aAAS,YAAY,MAAK;AACxB,UAAI;AACJ,UAAI;AAEJ,iBAAW,MAAW;AACpB,cAAM,UAAU,QAAQ,aAAa,eAAe,CAAA,GAAI;UACtD,UAAU,GAAG,UAAU;SACxB;AACD,cAAM,YAAY,QAAQ,aAAa,UAAU,CAAC,UAAU,CAAC;AAC7D,cAAM,YAAY,QAAQ,aAAa,iBAAiB,CAAA,GAAI;UAC1D,UAAU;SACX;AAED,cAAM,QAAQ,uBAAuB;UACnC,SAAS,CAAC,QAAQ;UAClB,WAAW;YACT,EAAE,SAAS,QAAQ,UAAU,UAAS;YACtC,EAAE,SAAS,aAAa,UAAU,QAAO;YACzC;YACA,EAAE,SAAS,eAAe,UAAU,UAAS;;SAEhD,EAAE,kBAAiB;AAEpB,kBAAU,QAAQ,gBAAgB,QAAQ;AAC1C,oBAAY,QAAQ;AACpB,gBAAQ,cAAa;MACvB,EAAC;AAED,SAAG,iBAAiB,MAAK;AACvB,eAAO,SAAS,EAAE,WAAU;MAC9B,CAAC;IACH,CAAC;;;",
  "names": ["home_page_default", "init_home_page", "HomePage", "init_home_page"]
}
