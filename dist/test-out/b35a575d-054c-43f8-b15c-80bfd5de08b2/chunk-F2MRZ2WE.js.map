{
  "version": 3,
  "sources": ["src/app/services/auth.service.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core';\r\nimport { APP_CONFIG } from '../config/app-config.token';\r\nimport { AppConfig } from '../config/app-config';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\ninterface Usuario {\r\n  nombre: string; // almacenado normalizado (lowercase + trim)\r\n  clave: string;  // demo: sin hash\r\n}\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class AuthService {\r\n  // observable para saber si hay usuario logueado\r\n  private usuarioSubject = new BehaviorSubject<string | null>(null);\r\n  usuario$ = this.usuarioSubject.asObservable();\r\n\r\n  private usuariosKey = 'usuarios';\r\n  private usuarioActualKey = 'usuarioActual';\r\n\r\n  constructor() {\r\n    this.cargarUsuarioDesdeStorage();\r\n  }\r\n\r\n  // --- utils ---\r\n\r\n  private norm(u: string): string {\r\n    return (u || '').trim().toLowerCase();\r\n  }\r\n\r\n  private obtenerUsuarios(): Usuario[] {\r\n    const usuariosStr = localStorage.getItem(this.usuariosKey);\r\n    try {\r\n      return usuariosStr ? JSON.parse(usuariosStr) : [];\r\n    } catch {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  private guardarUsuarios(users: Usuario[]) {\r\n    localStorage.setItem(this.usuariosKey, JSON.stringify(users));\r\n  }\r\n\r\n  // --- registro ---\r\n\r\n  registrarUsuario(nombre: string, clave: string): boolean {\r\n    const usuarios = this.obtenerUsuarios();\r\n    const nNombre = this.norm(nombre);\r\n\r\n    if (usuarios.find(u => u.nombre === nNombre)) {\r\n      return false; // ya existe\r\n    }\r\n\r\n    usuarios.push({ nombre: nNombre, clave });\r\n    this.guardarUsuarios(usuarios);\r\n    return true;\r\n  }\r\n\r\n  // --- validación de credenciales ---\r\n\r\n  validarUsuario(nombre: string, clave: string): boolean {\r\n    const nNombre = this.norm(nombre);\r\n    const usuarios = this.obtenerUsuarios();\r\n    const found = usuarios.find(u => u.nombre === nNombre);\r\n    return !!found && found.clave === clave;\r\n  }\r\n\r\n  // --- login / logout ---\r\n\r\n  login(nombre: string): void {\r\n    const nNombre = this.norm(nombre);\r\n    this.usuarioSubject.next(nNombre);\r\n    localStorage.setItem(this.usuarioActualKey, nNombre);\r\n  }\r\n\r\n  logout(): void {\r\n    this.usuarioSubject.next(null);\r\n    localStorage.removeItem(this.usuarioActualKey);\r\n  }\r\n\r\n  cargarUsuarioDesdeStorage(): void {\r\n    const usuario = localStorage.getItem(this.usuarioActualKey);\r\n    this.usuarioSubject.next(usuario);\r\n  }\r\n\r\n  // helper opcional: consulta rápida si hay usuario\r\n  isLoggedIn(): boolean {\r\n    return this.usuarioSubject.value !== null;\r\n  }\r\n\r\n  // util para pruebas\r\n  clearAll(): void {\r\n    localStorage.removeItem(this.usuariosKey);\r\n    localStorage.removeItem(this.usuarioActualKey);\r\n  }\r\n}\r\n\r\n\r\n\r\n"],
  "mappings": ";;;;;;;;;;;;;IAWa;;;;;AAXb;AAGA;AAQO,IAAM,cAAN,MAAMA,aAAW;MAQtB,cAAA;AANQ,aAAA,iBAAiB,IAAI,gBAA+B,IAAI;AAChE,aAAA,WAAW,KAAK,eAAe,aAAY;AAEnC,aAAA,cAAc;AACd,aAAA,mBAAmB;AAGzB,aAAK,0BAAyB;MAChC;;MAIQ,KAAK,GAAS;AACpB,gBAAQ,KAAK,IAAI,KAAI,EAAG,YAAW;MACrC;MAEQ,kBAAe;AACrB,cAAM,cAAc,aAAa,QAAQ,KAAK,WAAW;AACzD,YAAI;AACF,iBAAO,cAAc,KAAK,MAAM,WAAW,IAAI,CAAA;QACjD,QAAQ;AACN,iBAAO,CAAA;QACT;MACF;MAEQ,gBAAgB,OAAgB;AACtC,qBAAa,QAAQ,KAAK,aAAa,KAAK,UAAU,KAAK,CAAC;MAC9D;;MAIA,iBAAiB,QAAgB,OAAa;AAC5C,cAAM,WAAW,KAAK,gBAAe;AACrC,cAAM,UAAU,KAAK,KAAK,MAAM;AAEhC,YAAI,SAAS,KAAK,OAAK,EAAE,WAAW,OAAO,GAAG;AAC5C,iBAAO;QACT;AAEA,iBAAS,KAAK,EAAE,QAAQ,SAAS,MAAK,CAAE;AACxC,aAAK,gBAAgB,QAAQ;AAC7B,eAAO;MACT;;MAIA,eAAe,QAAgB,OAAa;AAC1C,cAAM,UAAU,KAAK,KAAK,MAAM;AAChC,cAAM,WAAW,KAAK,gBAAe;AACrC,cAAM,QAAQ,SAAS,KAAK,OAAK,EAAE,WAAW,OAAO;AACrD,eAAO,CAAC,CAAC,SAAS,MAAM,UAAU;MACpC;;MAIA,MAAM,QAAc;AAClB,cAAM,UAAU,KAAK,KAAK,MAAM;AAChC,aAAK,eAAe,KAAK,OAAO;AAChC,qBAAa,QAAQ,KAAK,kBAAkB,OAAO;MACrD;MAEA,SAAM;AACJ,aAAK,eAAe,KAAK,IAAI;AAC7B,qBAAa,WAAW,KAAK,gBAAgB;MAC/C;MAEA,4BAAyB;AACvB,cAAM,UAAU,aAAa,QAAQ,KAAK,gBAAgB;AAC1D,aAAK,eAAe,KAAK,OAAO;MAClC;;MAGA,aAAU;AACR,eAAO,KAAK,eAAe,UAAU;MACvC;;MAGA,WAAQ;AACN,qBAAa,WAAW,KAAK,WAAW;AACxC,qBAAa,WAAW,KAAK,gBAAgB;MAC/C;;;;;AAlFW,kBAAW,WAAA;MADvB,WAAW,EAAE,YAAY,OAAM,CAAE;OACrB,WAAW;;;",
  "names": ["AuthService"]
}
