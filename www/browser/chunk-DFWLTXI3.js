import{A as ee,B as te,c as H,d as $,f as W,i as K,j as Q,w as X,x as Y,z as Z}from"./chunk-4TXRC6IA.js";import"./chunk-3UM3HIIS.js";import"./chunk-QUJFQN2Y.js";import"./chunk-XNHTIZJD.js";import"./chunk-ZINMVDVP.js";import"./chunk-7Q4XLJYQ.js";import"./chunk-RKTKMO2W.js";import"./chunk-H473PMB4.js";import"./chunk-VV4OZZV3.js";import"./chunk-QNCTVU3D.js";import"./chunk-54GZX5XS.js";import"./chunk-5BRO6Q2L.js";import"./chunk-GWR6W3C3.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-JPAE2ESC.js";import"./chunk-CKP3SGE2.js";import"./chunk-AFUYUMCB.js";import"./chunk-6XRCHWW2.js";import{B as x,C as h,Ea as T,Fa as k,Ga as M,L,M as p,R as P,Ra as z,T as R,Ta as G,Ua as q,Va as J,X as I,aa as y,ba as l,ca as r,da as u,db as B,fb as j,ja as w,ka as b,la as _,sa as O,ta as N,ua as A,wa as s,xa as V,ya as C}from"./chunk-APMANMIP.js";import{a as U,c as D,d as ae}from"./chunk-EZHH7EW6.js";import"./chunk-5XPTL2YD.js";import"./chunk-DFETTOGW.js";import"./chunk-3SFUVCX7.js";import"./chunk-DGM7SJPU.js";import"./chunk-DNTR6X5U.js";import"./chunk-M2X7KQLB.js";import"./chunk-XTVTS2NW.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{h as d}from"./chunk-B7O3QC5Z.js";var v=(function(n){return n.Prompt="PROMPT",n.Camera="CAMERA",n.Photos="PHOTOS",n})(v||{}),E=(function(n){return n.Rear="REAR",n.Front="FRONT",n})(E||{}),F=(function(n){return n.Uri="uri",n.Base64="base64",n.DataUrl="dataUrl",n})(F||{});var S=class extends ae{getPhoto(i){return d(this,null,function*(){return new Promise((t,a)=>d(this,null,function*(){if(i.webUseInput||i.source===v.Photos)this.fileInputExperience(i,t,a);else if(i.source===v.Prompt){let e=document.querySelector("pwa-action-sheet");e||(e=document.createElement("pwa-action-sheet"),document.body.appendChild(e)),e.header=i.promptLabelHeader||"Photo",e.cancelable=!1,e.options=[{title:i.promptLabelPhoto||"From Photos"},{title:i.promptLabelPicture||"Take Picture"}],e.addEventListener("onSelection",o=>d(this,null,function*(){o.detail===0?this.fileInputExperience(i,t,a):this.cameraExperience(i,t,a)}))}else this.cameraExperience(i,t,a)}))})}pickImages(i){return d(this,null,function*(){return new Promise((t,a)=>d(this,null,function*(){this.multipleFileInputExperience(t,a)}))})}cameraExperience(i,t,a){return d(this,null,function*(){if(customElements.get("pwa-camera-modal")){let e=document.createElement("pwa-camera-modal");e.facingMode=i.direction===E.Front?"user":"environment",document.body.appendChild(e);try{yield e.componentOnReady(),e.addEventListener("onPhoto",o=>d(this,null,function*(){let c=o.detail;c===null?a(new U("User cancelled photos app")):c instanceof Error?a(c):t(yield this._getCameraPhoto(c,i)),e.dismiss(),document.body.removeChild(e)})),e.present()}catch{this.fileInputExperience(i,t,a)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(i,t,a)})}fileInputExperience(i,t,a){let e=document.querySelector("#_capacitor-camera-input"),o=()=>{var c;(c=e.parentNode)===null||c===void 0||c.removeChild(e)};e||(e=document.createElement("input"),e.id="_capacitor-camera-input",e.type="file",e.hidden=!0,document.body.appendChild(e),e.addEventListener("change",c=>{let m=e.files[0],g="jpeg";if(m.type==="image/png"?g="png":m.type==="image/gif"&&(g="gif"),i.resultType==="dataUrl"||i.resultType==="base64"){let f=new FileReader;f.addEventListener("load",()=>{if(i.resultType==="dataUrl")t({dataUrl:f.result,format:g});else if(i.resultType==="base64"){let re=f.result.split(",")[1];t({base64String:re,format:g})}o()}),f.readAsDataURL(m)}else t({webPath:URL.createObjectURL(m),format:g}),o()}),e.addEventListener("cancel",c=>{a(new U("User cancelled photos app")),o()})),e.accept="image/*",e.capture=!0,i.source===v.Photos||i.source===v.Prompt?e.removeAttribute("capture"):i.direction===E.Front?e.capture="user":i.direction===E.Rear&&(e.capture="environment"),e.click()}multipleFileInputExperience(i,t){let a=document.querySelector("#_capacitor-camera-input-multiple"),e=()=>{var o;(o=a.parentNode)===null||o===void 0||o.removeChild(a)};a||(a=document.createElement("input"),a.id="_capacitor-camera-input-multiple",a.type="file",a.hidden=!0,a.multiple=!0,document.body.appendChild(a),a.addEventListener("change",o=>{let c=[];for(let m=0;m<a.files.length;m++){let g=a.files[m],f="jpeg";g.type==="image/png"?f="png":g.type==="image/gif"&&(f="gif"),c.push({webPath:URL.createObjectURL(g),format:f})}i({photos:c}),e()}),a.addEventListener("cancel",o=>{t(new U("User cancelled photos app")),e()})),a.accept="image/*",a.click()}_getCameraPhoto(i,t){return new Promise((a,e)=>{let o=new FileReader,c=i.type.split("/")[1];t.resultType==="uri"?a({webPath:URL.createObjectURL(i),format:c,saved:!1}):(o.readAsDataURL(i),o.onloadend=()=>{let m=o.result;t.resultType==="dataUrl"?a({dataUrl:m,format:c,saved:!1}):a({base64String:m.split(",")[1],format:c,saved:!1})},o.onerror=m=>{e(m)})})}checkPermissions(){return d(this,null,function*(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}})}requestPermissions(){return d(this,null,function*(){throw this.unimplemented("Not implemented on web.")})}pickLimitedLibraryPhotos(){return d(this,null,function*(){throw this.unavailable("Not implemented on web.")})}getLimitedLibraryPhotos(){return d(this,null,function*(){throw this.unavailable("Not implemented on web.")})}},he=new S;var ne=D("Camera",{web:()=>new S});function le(n){n.CapacitorUtils.Synapse=new Proxy({},{get(i,t){return new Proxy({},{get(a,e){return(o,c,m)=>{let g=n.Capacitor.Plugins[t];if(g===void 0){m(new Error(`Capacitor plugin ${t} not found`));return}if(typeof g[e]!="function"){m(new Error(`Method ${e} not found in Capacitor plugin ${t}`));return}d(null,null,function*(){try{let f=yield g[e](o);c(f)}catch(f){m(f)}})}}})}})}function ce(n){n.CapacitorUtils.Synapse=new Proxy({},{get(i,t){return n.cordova.plugins[t]}})}function ie(n=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!n?le(window):window.cordova!==void 0&&ce(window))}var oe=D("Geolocation",{web:()=>import("./chunk-FGIUVHEX.js").then(n=>new n.GeolocationWeb)});ie();function se(n,i){if(n&1){let t=w();l(0,"div",33)(1,"div",34),u(2,"img",35),r(),l(3,"div",36)(4,"ion-button",37),b("click",function(){x(t);let e=_(2);return h(e.borrarFoto())}),u(5,"ion-icon",38),s(6," Eliminar foto "),r(),l(7,"ion-button",39),b("click",function(){x(t);let e=_(2);return h(e.tomarFoto())}),u(8,"ion-icon",40),s(9," Cambiar "),r()()()}if(n&2){let t=_(2);p(2),y("src",t.tarea.fotoData,L)}}function de(n,i){if(n&1){let t=w();l(0,"div",41)(1,"p",42),s(2,"No hay imagen adjunta."),r(),l(3,"ion-button",43),b("click",function(){x(t);let e=_(2);return h(e.tomarFoto())}),u(4,"ion-icon",44),s(5," Tomar foto "),r()()}}function me(n,i){if(n&1){let t=w();l(0,"div",45)(1,"p")(2,"strong"),s(3,"Lat:"),r(),s(4),T(5,"number"),u(6,"br"),l(7,"strong"),s(8,"Lng:"),r(),s(9),T(10,"number"),r(),l(11,"ion-button",46),b("click",function(){x(t);let e=_(2);return h(e.verEnMapa())}),u(12,"ion-icon",47),s(13," Ver en Google Maps "),r()()}if(n&2){let t=_(2);p(4),C(" ",k(5,2,t.tarea.lat,"1.6-6")," "),p(5),C(" ",k(10,5,t.tarea.lng,"1.6-6")," ")}}function pe(n,i){if(n&1){let t=w();l(0,"div",48)(1,"p",42),s(2,"Sin ubicaci\xF3n guardada."),r(),l(3,"ion-button",49),b("click",function(){x(t);let e=_(2);return h(e.obtenerUbicacion())}),u(4,"ion-icon",50),s(5," Obtener ubicaci\xF3n "),r()()}}function ue(n,i){if(n&1){let t=w();l(0,"div",12)(1,"div",13)(2,"div",14)(3,"h1",15),s(4),r(),l(5,"div",16)(6,"span",17),u(7,"ion-icon",18),s(8),T(9,"date"),r(),l(10,"span",19),s(11),r()()(),l(12,"div",20)(13,"p",21),s(14),r()(),l(15,"div",22)(16,"div",23),u(17,"ion-icon",24),s(18," Foto "),r(),I(19,se,10,1,"div",25)(20,de,6,0,"ng-template",null,1,M),r(),u(22,"hr",26),l(23,"div",27)(24,"div",23),u(25,"ion-icon",28),s(26," Ubicaci\xF3n "),r(),I(27,me,14,8,"div",29)(28,pe,6,0,"ng-template",null,2,M),r()(),l(30,"div",30)(31,"ion-button",31),b("click",function(){x(t);let e=_();return h(e.toggleEstado())}),u(32,"ion-icon",32),s(33),r()()()}if(n&2){let t=O(21),a=O(29),e=_();p(),N("--note-bg","var(--note-"+((e.tarea==null?null:e.tarea.color)||"gray")+")"),p(3),V(e.tarea.titulo),p(4),C(" ",k(9,15,e.tarea.updatedAt||e.tarea.createdAt,"d MMM yyyy, HH:mm")," "),p(2),A("done",e.tarea.completada),p(),C(" ",e.tarea.completada?"Completada":"Pendiente"," "),p(3),V(e.tarea.descripcion),p(5),y("ngIf",e.tarea.fotoData)("ngIfElse",t),p(8),y("ngIf",e.tarea.lat&&e.tarea.lng)("ngIfElse",a),p(4),y("color",e.tarea.completada?"medium":"success"),p(),y("name",e.tarea.completada?"arrow-undo":"checkmark-circle"),p(),C(" ",e.tarea.completada?"Marcar como Pendiente":"Marcar como Completada"," ")}}function ge(n,i){if(n&1){let t=w();l(0,"div",51),u(1,"ion-icon",52),l(2,"h3"),s(3,"Tarea no encontrada"),r(),l(4,"p"),s(5,"Es posible que esta tarea haya sido eliminada."),r(),l(6,"ion-button",53),b("click",function(){x(t);let e=_();return h(e.volver())}),s(7,"Volver al inicio"),r()()}}var Ae=(()=>{class n{constructor(t,a,e,o){this.route=t,this.router=a,this.alertCtrl=e,this.toastCtrl=o}ngOnInit(){this.cargarTarea()}ionViewWillEnter(){this.cargarTarea()}cargarTarea(){let t=Number(this.route.snapshot.paramMap.get("id")),a=JSON.parse(localStorage.getItem("tareas")||"[]");this.tarea=a.find(e=>e.id===t),this.tarea||this.router.navigate(["/home"])}guardarTareaActualizada(){let t=JSON.parse(localStorage.getItem("tareas")||"[]"),a=t.findIndex(e=>e.id===this.tarea.id);a!==-1&&(t[a]=this.tarea,localStorage.setItem("tareas",JSON.stringify(t)))}tomarFoto(){return d(this,null,function*(){try{let t=yield ne.getPhoto({quality:70,resultType:F.DataUrl,source:v.Camera});t&&t.dataUrl&&(this.tarea.fotoData=t.dataUrl,this.guardarTareaActualizada(),yield(yield this.toastCtrl.create({message:"Foto guardada en la tarea",duration:2e3,color:"success"})).present())}catch(t){console.error("[Camera] Error",t),yield(yield this.toastCtrl.create({message:"No se pudo tomar la foto",duration:2e3,color:"danger"})).present()}})}borrarFoto(){return d(this,null,function*(){if(!this.tarea)return;let t=JSON.parse(localStorage.getItem("tareas")||"[]"),a=t.findIndex(e=>e.id===this.tarea.id);a!==-1&&(t[a].fotoData=null,localStorage.setItem("tareas",JSON.stringify(t)),this.tarea.fotoData=null,yield(yield this.toastCtrl.create({message:"Foto eliminada correctamente",duration:2e3,color:"warning"})).present())})}obtenerUbicacion(){return d(this,null,function*(){try{let t=yield oe.getCurrentPosition();this.tarea.lat=t.coords.latitude,this.tarea.lng=t.coords.longitude,this.guardarTareaActualizada(),yield(yield this.toastCtrl.create({message:"Ubicaci\xF3n guardada en la tarea",duration:2e3,color:"success"})).present()}catch(t){console.error("[Geo] Error",t),yield(yield this.toastCtrl.create({message:"No se pudo obtener la ubicaci\xF3n",duration:2e3,color:"danger"})).present()}})}verEnMapa(){if(!this.tarea?.lat||!this.tarea?.lng)return;let t=`https://www.google.com/maps?q=${this.tarea.lat},${this.tarea.lng}`;window.open(t,"_blank")}volver(){this.router.navigate(["/home"])}toggleEstado(){let t=JSON.parse(localStorage.getItem("tareas")||"[]"),a=t.findIndex(e=>e.id===this.tarea.id);a!==-1&&(t[a].completada=!t[a].completada,t[a].updatedAt=new Date().toISOString(),localStorage.setItem("tareas",JSON.stringify(t)),this.tarea.completada=t[a].completada,this.tarea.updatedAt=t[a].updatedAt)}editar(){this.router.navigate(["/editar-tarea",this.tarea.id])}eliminar(){return d(this,null,function*(){yield(yield this.alertCtrl.create({header:"Confirmar eliminaci\xF3n",message:"\xBFEst\xE1s seguro de que deseas eliminar esta tarea?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",handler:()=>d(this,null,function*(){let e=JSON.parse(localStorage.getItem("tareas")||"[]").filter(c=>c.id!==this.tarea.id);localStorage.setItem("tareas",JSON.stringify(e)),yield(yield this.toastCtrl.create({message:"Tarea eliminada correctamente",duration:2e3,color:"danger"})).present(),this.router.navigate(["/home"])})}]})).present()})}static{this.\u0275fac=function(a){return new(a||n)(P(B),P(j),P(Z),P(ee))}}static{this.\u0275cmp=R({type:n,selectors:[["app-detalle-tarea"]],decls:13,vars:2,consts:[["noEncontrada",""],["sinFoto",""],["sinUbicacion",""],[1,"ion-no-border"],[1,"glass-header"],["slot","start"],["defaultHref","/home","color","primary","text",""],["slot","end"],["color","primary",2,"font-weight","600",3,"click"],["color","danger",2,"font-weight","600",3,"click"],[1,"ion-padding","detail-content"],["class","detail-container animate-entry",4,"ngIf","ngIfElse"],[1,"detail-container","animate-entry"],[1,"note-detail-card"],[1,"detail-header"],[1,"detail-title"],[1,"detail-meta"],[1,"date"],["name","calendar-outline"],[1,"status-badge"],[1,"detail-body"],[1,"description"],[1,"foto-section"],[1,"section-title"],["name","camera-outline"],["class","foto-wrapper animate-entry",4,"ngIf","ngIfElse"],[1,"divider"],[1,"ubicacion-section"],["name","location-outline"],["class","location-data",4,"ngIf","ngIfElse"],[1,"actions-container"],["expand","block",1,"action-btn",3,"click","color"],["slot","start",3,"name"],[1,"foto-wrapper","animate-entry"],[1,"img-container"],["alt","Foto de la tarea",1,"foto-tarea",3,"src"],[1,"foto-actions"],["color","danger","fill","outline","size","small",3,"click"],["name","trash-outline","slot","start"],["color","primary","fill","clear","size","small",3,"click"],["name","camera-reverse-outline","slot","start"],[1,"empty-photo-state"],[1,"hint"],["expand","block","color","primary",3,"click"],["name","camera","slot","start"],[1,"location-data"],["expand","block","fill","outline","color","tertiary",1,"map-btn",3,"click"],["name","map-outline","slot","start"],[1,"empty-location-state"],["expand","block","color","medium",3,"click"],["name","navigate-circle-outline","slot","start"],[1,"empty-state","centered"],["name","alert-circle-outline","color","medium","size","large"],["fill","clear",3,"click"]],template:function(a,e){if(a&1){let o=w();l(0,"ion-header",3)(1,"ion-toolbar",4)(2,"ion-buttons",5),u(3,"ion-back-button",6),r(),l(4,"ion-buttons",7)(5,"ion-button",8),b("click",function(){return x(o),h(e.editar())}),s(6," Editar "),r(),l(7,"ion-button",9),b("click",function(){return x(o),h(e.eliminar())}),s(8," Eliminar "),r()()()(),l(9,"ion-content",10),I(10,ue,34,18,"div",11)(11,ge,8,0,"ng-template",null,0,M),r()}if(a&2){let o=O(12);p(10),y("ngIf",e.tarea)("ngIfElse",o)}},dependencies:[J,z,te,H,$,W,K,Q,X,Y,q,G],styles:[".detail-content[_ngcontent-%COMP%]{--background: var(--ion-background-color)}.detail-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding-top:16px}.note-detail-card[_ngcontent-%COMP%]{background-color:var(--note-bg, #fff);border-radius:24px;padding:32px;box-shadow:0 8px 30px #00000014;margin-bottom:32px;position:relative;overflow:hidden}.note-detail-card[_ngcontent-%COMP%]:not([style*=--note-bg]){background-color:var(--ion-card-background)}.detail-header[_ngcontent-%COMP%]{margin-bottom:24px;border-bottom:1px solid rgba(0,0,0,.05);padding-bottom:16px}.detail-title[_ngcontent-%COMP%]{font-size:28px;font-weight:700;margin:0 0 12px;color:#222;line-height:1.2}.detail-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;font-size:14px;color:#0009}.date[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.date[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:20px;background:#0000000d;font-weight:600;font-size:12px;text-transform:uppercase;letter-spacing:.5px}.status-badge.done[_ngcontent-%COMP%]{background:var(--ion-color-success);color:#fff}.detail-body[_ngcontent-%COMP%]{font-size:18px;line-height:1.6;color:#333;white-space:pre-wrap}body.dark[_ngcontent-%COMP%]   .note-detail-card[_ngcontent-%COMP%]:not([style*=--note-bg])   .detail-title[_ngcontent-%COMP%]{color:var(--ion-text-color)}body.dark[_ngcontent-%COMP%]   .note-detail-card[_ngcontent-%COMP%]:not([style*=--note-bg])   .detail-body[_ngcontent-%COMP%]{color:var(--ion-text-color)}body.dark[_ngcontent-%COMP%]   .note-detail-card[_ngcontent-%COMP%]:not([style*=--note-bg])   .detail-meta[_ngcontent-%COMP%]{color:var(--ion-color-medium)}.actions-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.action-btn[_ngcontent-%COMP%]{height:56px;font-size:16px;font-weight:600;--border-radius: 16px;--box-shadow: 0 4px 12px rgba(0, 0, 0, .1)}.empty-state[_ngcontent-%COMP%]{text-align:center;margin-top:100px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;color:var(--ion-color-medium)}.foto-section[_ngcontent-%COMP%], .ubicacion-section[_ngcontent-%COMP%]{margin-top:16px;margin-bottom:16px}.foto-preview[_ngcontent-%COMP%]{margin-bottom:8px}.foto-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:220px;border-radius:12px;object-fit:cover;display:block}.hint[_ngcontent-%COMP%]{font-size:.85rem;color:#6b7280}"]})}}return n})();export{Ae as DetalleTareaPage};
