import{a as ne}from"./chunk-UZELX2NR.js";import{B as te,b as Q,c as U,d as W,f as $,g as R,h as G,i as K,j as X,r as Y,v as Z,w as ee}from"./chunk-4TXRC6IA.js";import"./chunk-3UM3HIIS.js";import"./chunk-QUJFQN2Y.js";import"./chunk-XNHTIZJD.js";import"./chunk-ZINMVDVP.js";import"./chunk-7Q4XLJYQ.js";import"./chunk-RKTKMO2W.js";import"./chunk-H473PMB4.js";import"./chunk-VV4OZZV3.js";import"./chunk-QNCTVU3D.js";import"./chunk-54GZX5XS.js";import"./chunk-5BRO6Q2L.js";import"./chunk-GWR6W3C3.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-JPAE2ESC.js";import"./chunk-CKP3SGE2.js";import"./chunk-AFUYUMCB.js";import{a as oe}from"./chunk-2CEGW7BT.js";import{A as j,H as J,y as L}from"./chunk-6XRCHWW2.js";import{Aa as H,B as d,Ba as F,C as m,Ca as N,Da as D,Ga as V,L as w,M as l,Qa as A,R as _,Ra as q,T as S,Ta as b,Va as B,X as f,aa as g,ba as n,ca as o,da as h,fb as z,ja as P,ka as v,la as x,sa as k,ta as I,ua as E,wa as c,xa as y,ya as T}from"./chunk-APMANMIP.js";import"./chunk-EZHH7EW6.js";import"./chunk-5XPTL2YD.js";import"./chunk-DFETTOGW.js";import"./chunk-3SFUVCX7.js";import"./chunk-DGM7SJPU.js";import"./chunk-DNTR6X5U.js";import"./chunk-M2X7KQLB.js";import"./chunk-XTVTS2NW.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as C,b as M,h as O}from"./chunk-B7O3QC5Z.js";function re(i,p){if(i&1&&(n(0,"div",30),h(1,"img",31),o()),i&2){let e=x().$implicit;l(),g("src",e.fotoData,w)}}function ae(i,p){i&1&&h(0,"ion-icon",32)}function ce(i,p){if(i&1){let e=P();n(0,"div",20),v("click",function(){let r=d(e).$implicit,a=x(2);return m(a.verDetalle(r))}),f(1,re,2,1,"div",21),n(2,"div",22)(3,"div",23)(4,"h2",24),c(5),o(),f(6,ae,1,0,"ion-icon",25),o(),n(7,"p",26),c(8),o(),n(9,"div",27)(10,"span",28),c(11),o(),n(12,"span",29),c(13),o()()()()}if(i&2){let e=p.$implicit,t=x(2);I("--note-color",t.getNoteBg(e.color)),l(),g("ngIf",e.fotoData),l(4),y(e.titulo),l(),g("ngIf",e.completada),l(2),y(e.descripcion),l(3),y(t.formatFechaHora(e.updatedAt||e.createdAt)),l(),E("done",e.completada),l(),T(" ",e.completada?"Listo":"Pendiente"," ")}}function le(i,p){if(i&1&&(n(0,"div",18),f(1,ce,14,10,"div",19),o()),i&2){let e=x();l(),g("ngForOf",e.tareasFiltradas)}}function se(i,p){i&1&&(n(0,"div",33),h(1,"img",34),n(2,"h3"),c(3,"No hay nada por aqu\xED"),o(),n(4,"p"),c(5,"Toca el bot\xF3n + para crear una nota"),o()())}var de={sun:"var(--note-sun)",sky:"var(--note-sky)",mint:"var(--note-mint)",lavender:"var(--note-lavender)",peach:"var(--note-peach)",gray:"var(--note-gray)"},be=(()=>{class i{constructor(e,t,r,a){this.router=e,this.authService=t,this.datePipe=r,this.sqlite=a,this.tareas=[],this.nombreUsuario="",this.query="",this.palette=["sun","sky","mint","lavender","peach","gray"]}ngOnInit(){this.cargarTareas(),this.authService.usuario$.subscribe(e=>{this.nombreUsuario=e??""})}ionViewWillEnter(){return O(this,null,function*(){if(this.cargarTareas(),this.sqlite.isNative)try{let e=yield this.sqlite.list();console.log("[SQLite] Notas en tabla notes:",e)}catch(e){console.error("[SQLite] Error al listar notas",e)}else console.log("[SQLite] Ejecutando en web, usando solo localStorage por ahora")})}getNoteBg(e){return de[e||"gray"]}cargarTareas(){let e=localStorage.getItem("tareas"),t=e?JSON.parse(e):[],r=t.map(a=>{let s=a.createdAt??new Date().toISOString(),u=a.updatedAt??s,ie=a.color??"gray";return M(C({},a),{createdAt:s,updatedAt:u,color:ie})});JSON.stringify(t)!==JSON.stringify(r)&&localStorage.setItem("tareas",JSON.stringify(r)),this.tareas=r}get tareasFiltradas(){let e=this.query.trim().toLowerCase();return e?this.tareas.filter(t=>(t.titulo||"").toLowerCase().includes(e)||(t.descripcion||"").toLowerCase().includes(e)):this.tareas}formatFechaHora(e){let t=e?new Date(e):new Date;return this.datePipe.transform(t,"MMM d, HH:mm","es-CL")??""}verDetalle(e){this.router.navigate(["/detalle-tarea",e.id])}irAgregar(){this.router.navigate(["/agregar-tarea"])}cerrarSesion(){this.authService.logout(),this.router.navigate(["/login"])}colorClass(e){return`note--${e.color??"gray"}`}irApiTareas(){this.router.navigate(["/api-tareas"])}static{this.\u0275fac=function(t){return new(t||i)(_(z),_(ne),_(b),_(oe))}}static{this.\u0275cmp=S({type:i,selectors:[["app-home"]],features:[D([b])],decls:26,vars:4,consts:[["sinTareas",""],[1,"ion-no-border"],[1,"glass-header"],["size","large",1,"main-title"],["slot","end"],["fill","clear",3,"click"],["color","primary",2,"font-weight","600",3,"click"],["fullscreen","",1,"ion-padding","home-content"],[1,"welcome-section","animate-entry"],[1,"greeting"],[1,"username"],[1,"subtitle"],[1,"search-container","animate-entry",2,"animation-delay","0.1s"],["placeholder","Buscar en tus notas...","debounce","150","showCancelButton","focus",1,"custom-search",3,"ngModelChange","ngModel"],["class","notes-grid animate-entry","style","animation-delay: 0.2s;",4,"ngIf","ngIfElse"],["vertical","bottom","horizontal","end","slot","fixed",1,"custom-fab"],["color","primary",3,"click"],["name","add"],[1,"notes-grid","animate-entry",2,"animation-delay","0.2s"],["class","note-card custom-card",3,"--note-color","click",4,"ngFor","ngForOf"],[1,"note-card","custom-card",3,"click"],["class","note-photo",4,"ngIf"],[1,"note-content"],[1,"note-header"],[1,"note-title"],["name","checkmark-circle","color","success",4,"ngIf"],[1,"note-desc"],[1,"note-footer"],[1,"note-date"],[1,"status-badge"],[1,"note-photo"],["alt","Foto tarea",3,"src"],["name","checkmark-circle","color","success"],[1,"empty-state","animate-entry",2,"animation-delay","0.2s"],["src","assets/icon/favicon.png","alt","No notes",1,"empty-img",2,"opacity","0.5","width","80px","filter","grayscale(1)"]],template:function(t,r){if(t&1){let a=P();n(0,"ion-header",1)(1,"ion-toolbar",2)(2,"ion-title",3),c(3,"Mis Notas"),o(),n(4,"ion-buttons",4)(5,"ion-button",5),v("click",function(){return d(a),m(r.irApiTareas())}),c(6,"API"),o(),n(7,"ion-button",6),v("click",function(){return d(a),m(r.cerrarSesion())}),c(8," Salir "),o()()()(),n(9,"ion-content",7)(10,"div",8)(11,"h1",9),c(12,"Hola, "),n(13,"span",10),c(14),o(),c(15," \u{1F44B}"),o(),n(16,"p",11),c(17,"\xBFQu\xE9 tienes en mente hoy?"),o()(),n(18,"div",12)(19,"ion-searchbar",13),N("ngModelChange",function(u){return d(a),F(r.query,u)||(r.query=u),m(u)}),o()(),f(20,le,2,1,"div",14)(21,se,6,0,"ng-template",null,0,V),n(23,"ion-fab",15)(24,"ion-fab-button",16),v("click",function(){return d(a),m(r.irAgregar())}),h(25,"ion-icon",17),o()()()}if(t&2){let a=k(22);l(14),y(r.nombreUsuario),l(5),H("ngModel",r.query),l(),g("ngIf",r.tareasFiltradas.length>0)("ngIfElse",a)}},dependencies:[B,A,q,te,U,W,$,R,G,K,X,Y,Z,ee,Q,J,L,j],styles:[".home-content[_ngcontent-%COMP%]{--background: var(--ion-background-color)}.main-title[_ngcontent-%COMP%]{font-weight:700;color:var(--ion-text-color);letter-spacing:-.5px}.welcome-section[_ngcontent-%COMP%]{margin-bottom:24px;padding:0 8px}.greeting[_ngcontent-%COMP%]{font-size:28px;font-weight:700;margin:0;color:var(--ion-text-color)}.greeting[_ngcontent-%COMP%]   .username[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.subtitle[_ngcontent-%COMP%]{font-size:16px;color:var(--ion-color-medium);margin-top:4px}.search-container[_ngcontent-%COMP%]{margin-bottom:24px}.custom-search[_ngcontent-%COMP%]{--background: #fff;--placeholder-color: var(--ion-color-medium);--icon-color: var(--ion-color-primary);padding-inline-start:0;padding-inline-end:0}body.dark[_ngcontent-%COMP%]   .custom-search[_ngcontent-%COMP%]{--background: #2a2a2a}.notes-grid[_ngcontent-%COMP%]{column-count:2;column-gap:16px;padding-bottom:80px}.note-card[_ngcontent-%COMP%]{break-inside:avoid;margin-bottom:16px;background-color:var(--note-color, #fff);border:1px solid rgba(0,0,0,.03);position:relative}.note-card[_ngcontent-%COMP%]:not([style*=--note-color]){background-color:var(--ion-card-background)}.note-photo[_ngcontent-%COMP%]{width:100%;max-height:140px;overflow:hidden;border-radius:12px;margin-bottom:8px}.note-photo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:140px;object-fit:cover;display:block}.note-content[_ngcontent-%COMP%]{padding:16px}.note-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px}.note-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin:0;color:#333;line-height:1.3}body.dark[_ngcontent-%COMP%]   .note-card[_ngcontent-%COMP%]:not([style*=--note-color])   .note-title[_ngcontent-%COMP%]{color:var(--ion-text-color)}.note-desc[_ngcontent-%COMP%]{font-size:14px;color:#000000b3;margin:0 0 12px;line-height:1.5;display:-webkit-box;-webkit-line-clamp:4;-webkit-box-orient:vertical;overflow:hidden;line-clamp:4}body.dark[_ngcontent-%COMP%]   .note-card[_ngcontent-%COMP%]:not([style*=--note-color])   .note-desc[_ngcontent-%COMP%]{color:var(--ion-color-medium)}.note-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:12px}.note-date[_ngcontent-%COMP%]{color:#00000080}body.dark[_ngcontent-%COMP%]   .note-card[_ngcontent-%COMP%]:not([style*=--note-color])   .note-date[_ngcontent-%COMP%]{color:var(--ion-color-medium)}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;background:#0000000d;color:#0009;font-weight:500}.status-badge.done[_ngcontent-%COMP%]{background:var(--ion-color-success);color:#fff}.empty-state[_ngcontent-%COMP%]{text-align:center;margin-top:60px;color:var(--ion-color-medium)}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;margin-bottom:8px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px}@media (min-width: 768px){.notes-grid[_ngcontent-%COMP%]{column-count:3}}@media (min-width: 1024px){.notes-grid[_ngcontent-%COMP%]{column-count:4}}"]})}}return i})();export{be as HomePage};
